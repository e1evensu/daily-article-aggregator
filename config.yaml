# æ¯æ—¥æ–‡ç« èšåˆå™¨é…ç½®æ–‡ä»¶
# Daily Article Aggregator Configuration

# æ•°æ®æºé…ç½®
sources:
  arxiv:
    enabled: true
    categories:
      - cs.AI      # äººå·¥æ™ºèƒ½
      - cs.CL      # è®¡ç®—è¯­è¨€å­¦
      - cs.CR      # å¯†ç å­¦ä¸å®‰å…¨
    keywords:
      - security
      - safety
      - llm
    use_llm_filter: false
    max_results: 1000
  
  rss:
    enabled: true
    # ä½¿ç”¨åˆå¹¶åçš„OPMLæ–‡ä»¶ï¼ˆåŒ…å«æ‰€æœ‰è¯„ä¼°é€šè¿‡çš„è®¢é˜…æºï¼‰
    opml_path: "merged_feeds.opml"
    # é¢å¤–çš„OPMLæ–‡ä»¶åˆ—è¡¨ï¼ˆç”¨äºè¯„ä¼°ï¼‰
    opml_files:
      - "rss/CyberSecurityRSS.opml"        # ç½‘ç»œå®‰å…¨RSSï¼ˆå®Œæ•´ç‰ˆï¼‰
      - "rss/Chinese-Security-RSS.opml"    # ä¸­æ–‡å®‰å…¨RSS
      - "rss/awesome-security-feed.opml"   # ç²¾é€‰å®‰å…¨è®¢é˜…æº
      - "rss/chinese-independent-blogs.opml" # ä¸­æ–‡ç‹¬ç«‹åšå®¢
      - "rss/SecureRss.opml"               # å®‰å…¨RSSï¼ˆå¤§å‹ï¼‰
      - "rss/wechatRSS.opml"               # å¾®ä¿¡å…¬ä¼—å·RSS
      - "rss/hn-popular-blogs-2025.opml"   # HNçƒ­é—¨åšå®¢2025ï¼ˆ92ä¸ªé«˜è´¨é‡æŠ€æœ¯åšå®¢ï¼‰
      - "rss/hn-top-blogs.opml"            # HN Top 90 åšå®¢ï¼ˆKarpathyæ¨èï¼‰

# AIé…ç½®ï¼ˆæ‰€æœ‰å€¼éƒ½æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–ï¼‰
ai:
  enabled: true
  api_base: "${OPENAI_API_BASE:https://api.openai.com/v1}"
  api_key: "${OPENAI_API_KEY}"
  model: "${OPENAI_MODEL:gpt-4o-mini}"
  max_tokens: 200000
  temperature: 0.7
  timeout: 60
  translate: true
  system_prompt: |
    ä½ æ˜¯ä¸€åä¸“ä¸šçš„æŠ€æœ¯æ–‡æ¡£åˆ†æå¸ˆï¼Œæ“…é•¿é˜…è¯»å’Œæ€»ç»“æŠ€æœ¯æ–‡ç« ã€‚
    ä½ çš„ä»»åŠ¡æ˜¯ï¼š
    1. æå–æ–‡ç« çš„æ ¸å¿ƒè§‚ç‚¹å’Œå…³é”®ä¿¡æ¯
    2. ç”Ÿæˆç®€æ´å‡†ç¡®çš„ä¸­æ–‡æ‘˜è¦
    3. ä¸ºæ–‡ç« åˆ†é…åˆé€‚çš„æŠ€æœ¯åˆ†ç±»
    
    è¯·ç¡®ä¿æ‘˜è¦ç®€æ´æ˜äº†ï¼Œçªå‡ºæ–‡ç« çš„ä¸»è¦è´¡çŒ®å’Œä»·å€¼ã€‚

# é£ä¹¦é…ç½®
feishu:
  webhook_url: "${FEISHU_WEBHOOK_URL}"

# é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®ï¼ˆç”¨äºæ•°æ®å¯è§†åŒ–ï¼‰
feishu_bitable:
  enabled: true
  app_id: "${FEISHU_APP_ID}"
  app_secret: "${FEISHU_APP_SECRET}"
  app_token: "${FEISHU_BITABLE_APP_TOKEN:}"  # é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»º
  table_id: "${FEISHU_BITABLE_TABLE_ID:}"    # é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»º

# ä»£ç†é…ç½®
proxy:
  url: ""
  enabled: false

# è°ƒåº¦é…ç½®
schedule:
  time: "07:00"
  timezone: "Asia/Shanghai"

# æ–­ç‚¹ç»­ä¼ é…ç½®
# Checkpoint/Resume Configuration
checkpoint:
  enabled: true                    # æ˜¯å¦å¯ç”¨æ–­ç‚¹ç»­ä¼ 
  dir: "data/checkpoints"          # æ£€æŸ¥ç‚¹æ–‡ä»¶å­˜å‚¨ç›®å½•
  max_age_hours: 24                # æ£€æŸ¥ç‚¹æœ€å¤§ä¿ç•™æ—¶é—´ï¼ˆå°æ—¶ï¼‰
  save_interval: 10                # è‡ªåŠ¨ä¿å­˜é—´éš”ï¼ˆæ¯å¤„ç†å¤šå°‘æ¡åä¿å­˜ï¼‰

# æ•°æ®åº“é…ç½®
database:
  path: "data/articles.db"

# å†…å®¹å¤„ç†é…ç½®
content:
  max_length: 5000000 # æœ€å¤§å†…å®¹é•¿åº¦ï¼ˆå­—ç¬¦ï¼‰
  truncation_marker: "\n\n... [å†…å®¹å·²æˆªæ–­]"

# æ–°æ•°æ®æºé…ç½®
# New Data Sources Configuration
data_sources:
  dblp:
    enabled: true
    conferences:
      - sp      # IEEE S&P
      - ccs     # ACM CCS
      - uss     # USENIX Security
      - ndss    # NDSS
    timeout: 30
  
  nvd:
    enabled: true
    api_key: "${NVD_API_KEY:}"
    days_back: 7
    timeout: 60
    min_cvss_score: 7.0  # åªä¿ç•™é«˜å±æ¼æ´ (CVSS >= 7.0)
  
  kev:
    enabled: true
    days_back: 30
    timeout: 30
  
  huggingface:
    enabled: true
    timeout: 30
  
  pwc:
    enabled: true
    limit: 50
    timeout: 30
  
  blogs:
    enabled: true
    sources:
      - openai
      - deepmind
      - anthropic
    timeout: 30
  
  hunyuan:
    enabled: true
    timeout: 30
    days_back: 7
    page_size: 20
  
  github:
    enabled: true
    token: "${GITHUB_TOKEN:}"
    topics:
      - security
      - llm
      - ai
      - machine-learning
      - cybersecurity
    min_stars: 100
    days_back: 7
    max_results: 50
    timeout: 30
  
  anthropic_red:
    enabled: true
    timeout: 30
  
  atum_blog:
    enabled: true
    timeout: 30
    days_back: 365  # æŠ“å–æœ€è¿‘ä¸€å¹´çš„æ–‡ç« 

# æ¼æ´è¿‡æ»¤é…ç½®
# Vulnerability Filter Configuration
vulnerability_filter:
  enabled: true
  github_star_threshold: 1000
  ip_asset_threshold: 300
  enable_ai_assessment: true
  github_token: "${GITHUB_TOKEN:}"

# åˆ†çº§æ¨é€é…ç½®
# Tiered Push Configuration
tiered_push:
  enabled: true
  level1_threshold: 0.10  # å‰ 10%
  level2_threshold: 0.40  # 10%-40%
  # level3 ä¸ºå‰©ä½™éƒ¨åˆ† (40%-100%)

# æ™ºèƒ½ç­›é€‰é…ç½®
# Smart Selector Configuration
smart_selector:
  enabled: true
  max_articles: 100         # æ¯æ—¥æœ€å¤šæ¨é€æ–‡ç« æ•°
  min_quality_score: 50     # æœ€ä½è´¨é‡åˆ†ï¼ˆ0-100ï¼‰
  source_balance: true      # æ˜¯å¦å¹³è¡¡ä¸åŒæ¥æº

# ä¼˜å…ˆçº§è¯„åˆ†é…ç½®
# Priority Scoring Configuration
priority_scoring:
  enabled: true
  source_weights:
    kev: 1.5      # KEV æ¼æ´æƒé‡æ›´é«˜
    nvd: 1.2
    dblp: 1.3     # é¡¶ä¼šè®ºæ–‡æƒé‡æ›´é«˜
    huggingface: 1.1
    pwc: 1.1
    blog: 1.0
    arxiv: 1.0
    rss: 0.8

# çŸ¥è¯†åº“é—®ç­”é…ç½®
# Knowledge QA Configuration
knowledge_qa:
  enabled: true
  
  # ChromaDB é…ç½®
  chroma:
    path: "data/chroma_db"
    collection_name: "knowledge_articles"
  
  # Embedding é…ç½®
  embedding:
    model: "Qwen/Qwen3-Embedding-8B"
  
  # äº‹ä»¶æœåŠ¡å™¨é…ç½®
  event_server:
    host: "0.0.0.0"
    port: 8080
    verification_token: "${FEISHU_VERIFICATION_TOKEN}"
    encrypt_key: "${FEISHU_ENCRYPT_KEY:}"
  
  # é—®ç­”é…ç½®
  qa:
    max_context_turns: 5
    context_ttl_minutes: 30
    max_retrieved_docs: 5
    min_relevance_score: 0.5
    answer_max_length: 40000
  
  # åˆ†å—é…ç½®
  chunking:
    chunk_size: 500
    chunk_overlap: 50
  
  # é¢‘ç‡é™åˆ¶
  rate_limit:
    requests_per_minute: 20
    requests_per_user_minute: 5

# è¯é¢˜èšåˆé…ç½®
# Topic Aggregation Configuration
topic_aggregation:
  enabled: true                     # å¯ç”¨è¯é¢˜èšåˆ
  similarity_threshold: 0.7         # ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆ0-1ï¼‰
  aggregation_threshold: 3          # èšåˆé˜ˆå€¼ï¼ˆè¾¾åˆ°æ­¤æ•°é‡è§¦å‘ç»¼è¿°ï¼‰
  time_window_days: 7               # æ—¶é—´çª—å£ï¼ˆå¤©ï¼‰
  title_weight: 0.6                 # æ ‡é¢˜æƒé‡
  keyword_weight: 0.4               # å…³é”®è¯æƒé‡
  use_ai_similarity: true           # ä½¿ç”¨ AI è®¡ç®—ç›¸ä¼¼åº¦ï¼ˆæ¨èï¼‰
  embedding_model: "Qwen/Qwen3-Embedding-8B"  # Embedding æ¨¡å‹
  # é»‘åå•åŸŸåï¼ˆä½è´¨é‡æ¥æºï¼‰
  blacklist_domains:
    - csdn.net
    - zhihu.com
    - jianshu.com
    - blog.51cto.com
  # å¯ä¿¡æ¥æºï¼ˆé«˜è´¨é‡æ¥æºï¼‰
  trusted_sources:
    - arxiv.org
    - github.com
    - openai.com
    - anthropic.com
    - deepmind.com

# RAG å¢å¼ºé…ç½®
# RAG Enhancement Configuration
# Requirements: 1.1, 1.5, 2.1, 2.5, 3.3
rag_enhancement:
  enabled: true                     # å¯ç”¨ RAG å¢å¼ºåŠŸèƒ½
  similarity_threshold: 0.5         # ç›¸ä¼¼åº¦é˜ˆå€¼ [0, 1]ï¼Œä½äºæ­¤é˜ˆå€¼çš„ç»“æœå°†è¢«è¿‡æ»¤
  max_chunks_per_doc: 3             # æ¯æ–‡æ¡£æœ€å¤§åˆ†å—æ•°ï¼Œ0 è¡¨ç¤ºæ— é™åˆ¶
  max_history_turns: 5              # æœ€å¤§å†å²å¯¹è¯è½®æ•°
  dedup_threshold: 0.95             # å»é‡ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œé«˜äºæ­¤é˜ˆå€¼çš„å†…å®¹å°†è¢«å»é‡

# é£ä¹¦åŒå‘äº¤äº’é…ç½®
# Feishu Interactive Bot Configuration
# Requirements: 14.x, 15.x, 16.x, 17.x
feishu_interactive:
  enabled: true                     # å¯ç”¨é£ä¹¦åŒå‘äº¤äº’
  app_id: "${FEISHU_APP_ID}"        # é£ä¹¦åº”ç”¨ ID
  app_secret: "${FEISHU_APP_SECRET}" # é£ä¹¦åº”ç”¨å¯†é’¥
  # äº‹ä»¶æœåŠ¡å™¨é…ç½®
  event_server:
    host: "0.0.0.0"
    port: 8080
    verification_token: "${FEISHU_VERIFICATION_TOKEN}"
    encrypt_key: "${FEISHU_ENCRYPT_KEY:}"
  # æ¶ˆæ¯å¤„ç†é…ç½®
  message_handling:
    always_respond: false           # æ˜¯å¦æ€»æ˜¯å“åº”ï¼ˆä¸éœ€è¦ @mentionï¼‰
    thread_replies: true            # æ˜¯å¦ä½¿ç”¨çº¿ç¨‹å›å¤
    low_confidence_threshold: 0.5   # ä½ç½®ä¿¡åº¦é˜ˆå€¼
    low_confidence_message: "âš ï¸ ä»¥ä¸‹å›ç­”ç½®ä¿¡åº¦è¾ƒä½ï¼Œä»…ä¾›å‚è€ƒï¼š"
    max_sources: 5                  # æœ€å¤§æ˜¾ç¤ºæ¥æºæ•°
  # äº‹ä»¶å»é‡é…ç½®
  deduplication:
    max_size: 10000                 # æœ€å¤§ç¼“å­˜å¤§å°
    ttl_seconds: 300                # äº‹ä»¶ ID è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰

# ç»Ÿè®¡åˆ†æç³»ç»Ÿé…ç½®
# Statistics Analysis System Configuration
# Requirements: 9.x, 10.x, 11.x, 12.x, 13.x
stats_system:
  enabled: true                     # å¯ç”¨ç»Ÿè®¡åˆ†æç³»ç»Ÿ
  db_path: "data/stats.db"          # ç»Ÿè®¡æ•°æ®åº“è·¯å¾„
  # é¡µé¢æµè§ˆç»Ÿè®¡é…ç½®
  page_views:
    dedup_window_seconds: 300       # å»é‡æ—¶é—´çª—å£ï¼ˆç§’ï¼‰ï¼ŒåŒä¸€ç”¨æˆ·åŒä¸€æ–‡ç« åœ¨æ­¤æ—¶é—´å†…åªè®¡ä¸€æ¬¡
  # é—®ç­”ç»Ÿè®¡é…ç½®
  qa_stats:
    track_queries: true             # æ˜¯å¦è®°å½•æŸ¥è¯¢å†…å®¹
    track_sources: true             # æ˜¯å¦è®°å½•æ¥æºä½¿ç”¨æƒ…å†µ
  # æ¥æºè´¨é‡è¯„ä¼°é…ç½®
  source_quality:
    min_fetch_count: 10             # æœ€å°æŠ“å–æ¬¡æ•°ï¼ˆä½äºæ­¤å€¼ä¸è®¡ç®—è´¨é‡åˆ†ï¼‰
    low_quality_threshold: 30       # ä½è´¨é‡é˜ˆå€¼ï¼ˆä½äºæ­¤åˆ†æ•°æ ‡è®°ä¸ºä½è´¨é‡ï¼‰
  # è¯é¢˜è¿½è¸ªé…ç½®
  topic_tracking:
    enabled: true                   # å¯ç”¨è¯é¢˜è¿½è¸ª
    min_keyword_length: 2           # æœ€å°å…³é”®è¯é•¿åº¦
    max_keywords_per_article: 10    # æ¯ç¯‡æ–‡ç« æœ€å¤§å…³é”®è¯æ•°
    spike_threshold: 2.0            # è¯é¢˜çªå¢æ£€æµ‹é˜ˆå€¼ï¼ˆå€æ•°ï¼‰
    use_jieba: true                 # ä½¿ç”¨ jieba åˆ†è¯ï¼ˆä¸­æ–‡ï¼‰
  # API é…ç½®
  api:
    cache_ttl_seconds: 300          # ç¼“å­˜ TTLï¼ˆç§’ï¼‰
    max_results: 100                # æœ€å¤§è¿”å›ç»“æœæ•°

# ç”¨æˆ·åé¦ˆé…ç½®
# User Feedback Configuration
feedback:
  enabled: true                      # å¯ç”¨ç”¨æˆ·åé¦ˆ
  db_path: "data/articles.db"        # åé¦ˆæ•°æ®åº“è·¯å¾„
  # åé¦ˆæç¤ºæ¶ˆæ¯
  prompt_message: |
    ğŸ’¡ åé¦ˆå‘½ä»¤ï¼š
    â€¢ "æœ‰ç”¨" / "æ²¡ç”¨" - å¿«é€Ÿåé¦ˆ
    â€¢ "æ”¶è—" - æ”¶è—æ­¤æ–‡ç« 
    â€¢ "æ›´å¤šç±»ä¼¼" - æ¨èæ›´å¤šåŒç±»æ–‡ç« 

# PDFç¿»è¯‘æœåŠ¡é…ç½®
# PDF Translation Service Configuration
pdf_translation:
  enabled: true                      # å¯ç”¨PDFç¿»è¯‘æœåŠ¡
  input_dir: "data/papers/input"     # PDFè¾“å…¥ç›®å½•
  output_dir: "data/papers/output"   # ç¿»è¯‘è¾“å‡ºç›®å½•
  # DeepSeek APIé…ç½®
  deepseek:
    api_key: "${DEEPSEEK_API_KEY:}"
    base_url: "https://api.deepseek.com"
    model: "deepseek-chat"
  # SiliconFlow APIé…ç½®ï¼ˆç”¨äºå›¾è¡¨ç†è§£ï¼‰
  siliconflow:
    api_key: "${SILICONFLOW_API_KEY:}"
    base_url: "https://api.siliconflow.cn/v1"
  # é£ä¹¦é…ç½®
  feishu:
    # ç¿»è¯‘å®Œæˆåæ˜¯å¦å‘é€é€šçŸ¥
    notify_on_complete: true
    # æ˜¯å¦å‘é€åˆ°ç¾¤èŠ
    send_to_group: true
  # ç¿»è¯‘é£æ ¼
  translation_style: "academic"       # academic(å­¦æœ¯) / casual(é€šä¿—)

# Sitemap å¯¼å…¥å™¨é…ç½®
# Sitemap Importer Configuration
# Requirements: 5.1, 6.1, 7.1, 8.1
sitemap_importer:
  enabled: true                     # å¯ç”¨ Sitemap å¯¼å…¥å™¨
  timeout: 30                       # HTTP è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰
  user_agent: "PandaWiki-SitemapImporter/1.0"  # User-Agent
  max_concurrent: 5                 # æœ€å¤§å¹¶å‘è¯·æ±‚æ•°
  delay_between_requests: 0.5       # è¯·æ±‚é—´å»¶è¿Ÿï¼ˆç§’ï¼‰
  state_dir: "data/sitemap_state"   # çˆ¬å–çŠ¶æ€å­˜å‚¨ç›®å½•
  source_type: "sitemap"            # æ¥æºç±»å‹æ ‡è¯†
  # ç¤ºä¾‹ Sitemap é…ç½®
  # Example Sitemap configurations
  sitemaps: []
    # - url: "https://example.com/sitemap.xml"
    #   include_patterns:
    #     - "/docs/*"
    #     - "/blog/*"
    #   exclude_patterns:
    #     - "*/archive/*"
    #     - "*/tag/*"
    #   use_regex: false
    #   category: "documentation"
    #   force_refresh: false
